{"mappings":"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","sources":["<anon>","src/index.ts","src/indexed-storage.ts"],"sourcesContent":["\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\nvar $f534e8972a5b1be2$exports = {};\n\n$parcel$export($f534e8972a5b1be2$exports, \"IndexedStorage\", () => $f534e8972a5b1be2$export$41a78aa1acdd6131);\n$parcel$export($f534e8972a5b1be2$exports, \"indexedStorage\", () => $f534e8972a5b1be2$export$5281f72867bab9d2);\n/**\n * Minimal Wrapper for indexedDB\n *\n * Based on this gist\n * https://gist.github.com/JamesMessinger/a0d6389a5d0e3a24814b\n */ const { indexedDB: $f534e8972a5b1be2$var$indexedDB } = window;\nclass $f534e8972a5b1be2$export$41a78aa1acdd6131 {\n    static VERSION = 1;\n    request;\n    promiseFulfilled;\n    dbPromise;\n    success = ()=>{\n        this.promiseFulfilled(this.request.result);\n    };\n    update = ()=>{\n        const db = this.request.result;\n        const store = db.createObjectStore('objects', {\n            keyPath: 'id'\n        });\n    // store.createIndex(\"NameIndex\", ['_created', '_modified'])\n    };\n    name;\n    constructor(name){\n        this.name = name;\n        const request = $f534e8972a5b1be2$var$indexedDB.open(name, $f534e8972a5b1be2$export$41a78aa1acdd6131.VERSION);\n        request.onsuccess = this.success;\n        request.onupgradeneeded = this.update;\n        this.dbPromise = new Promise((resolve)=>{\n            this.promiseFulfilled = resolve;\n        });\n        this.request = request;\n    }\n    async setItem(id, value) {\n        const db = await this.dbPromise;\n        const tx = db.transaction('objects', 'readwrite');\n        const store = tx.objectStore('objects');\n        return new Promise((resolve, reject)=>{\n            const req = store.put({\n                id: id,\n                value: value\n            });\n            req.onsuccess = ()=>resolve();\n            req.onerror = ()=>reject(req.error);\n        });\n    }\n    async getItem(id) {\n        const db = await this.dbPromise;\n        const tx = db.transaction('objects', 'readonly');\n        const store = tx.objectStore('objects');\n        return new Promise((resolve, reject)=>{\n            const req = store.get(id);\n            req.onsuccess = ()=>{\n                resolve(req.result?.value != null ? req.result.value : undefined);\n            };\n            req.onerror = ()=>reject(req.error);\n        });\n    }\n    async count() {\n        const db = await this.dbPromise;\n        const tx = db.transaction('objects', 'readonly');\n        const store = tx.objectStore('objects');\n        return new Promise((resolve, reject)=>{\n            const req = store.count();\n            req.onsuccess = ()=>{\n                resolve(req.result);\n            };\n            req.onerror = ()=>reject(req.error);\n        });\n    }\n    async allKeys() {\n        const db = await this.dbPromise;\n        const tx = db.transaction('objects', 'readonly');\n        const store = tx.objectStore('objects');\n        return new Promise((resolve, reject)=>{\n            const req = store.getAllKeys();\n            req.onsuccess = ()=>{\n                resolve(req.result);\n            };\n            req.onerror = ()=>reject(req.error);\n        });\n    }\n    async delete(id) {\n        const db = await this.dbPromise;\n        const tx = db.transaction('objects', 'readwrite');\n        const store = tx.objectStore('objects');\n        return new Promise((resolve, reject)=>{\n            const req = store.delete(id);\n            req.onsuccess = resolve;\n            req.onerror = ()=>reject(req.error);\n        });\n    }\n    async clear() {\n        const db = await this.dbPromise;\n        const tx = db.transaction('objects', 'readwrite');\n        const store = tx.objectStore('objects');\n        return new Promise((resolve, reject)=>{\n            const req = store.clear();\n            req.onsuccess = resolve;\n            req.onerror = ()=>reject(req.error);\n        });\n    }\n}\nconst $f534e8972a5b1be2$export$5281f72867bab9d2 = new $f534e8972a5b1be2$export$41a78aa1acdd6131('default-local-db');\n\n\n\n\nexport {$f534e8972a5b1be2$export$41a78aa1acdd6131 as IndexedStorage, $f534e8972a5b1be2$export$5281f72867bab9d2 as indexedStorage};\n//# sourceMappingURL=index.js.map\n","export * from './indexed-storage'\n","/**\n * Minimal Wrapper for indexedDB\n *\n * Based on this gist\n * https://gist.github.com/JamesMessinger/a0d6389a5d0e3a24814b\n */\n\nconst { indexedDB } = window\n\nexport class IndexedStorage {\n  static VERSION = 1\n\n  private request: any\n  private promiseFulfilled?: (db: any) => void\n  private dbPromise: Promise<any>\n\n  private success = () => {\n    this.promiseFulfilled!(this.request.result)\n  }\n\n  private update = () => {\n    const db = this.request.result\n    const store = db.createObjectStore('objects', { keyPath: 'id' })\n    // store.createIndex(\"NameIndex\", ['_created', '_modified'])\n  }\n\n  readonly name: string\n\n  constructor(name: string) {\n    this.name = name\n    const request = indexedDB.open(name, IndexedStorage.VERSION)\n    request.onsuccess = this.success\n    request.onupgradeneeded = this.update\n\n    this.dbPromise = new Promise((resolve) => {\n      this.promiseFulfilled = resolve\n    })\n\n    this.request = request\n  }\n\n  async setItem(id: string, value: any): Promise<void> {\n    const db = await this.dbPromise\n    const tx = db.transaction('objects', 'readwrite')\n    const store = tx.objectStore('objects')\n    return new Promise((resolve, reject) => {\n      const req = store.put({ id, value })\n      req.onsuccess = () => resolve()\n      req.onerror = () => reject(req.error)\n    })\n  }\n\n  async getItem(id: string): Promise<any | undefined> {\n    const db = await this.dbPromise\n    const tx = db.transaction('objects', 'readonly')\n    const store = tx.objectStore('objects')\n    return new Promise((resolve, reject) => {\n      const req = store.get(id)\n      req.onsuccess = () => {\n        resolve(req.result?.value != null ? req.result.value : undefined)\n      }\n      req.onerror = () => reject(req.error)\n    })\n  }\n\n  async count(): Promise<number> {\n    const db = await this.dbPromise\n    const tx = db.transaction('objects', 'readonly')\n    const store = tx.objectStore('objects')\n    return new Promise((resolve, reject) => {\n      const req = store.count()\n      req.onsuccess = () => {\n        resolve(req.result)\n      }\n      req.onerror = () => reject(req.error)\n    })\n  }\n\n  async allKeys(): Promise<string[]> {\n    const db = await this.dbPromise\n    const tx = db.transaction('objects', 'readonly')\n    const store = tx.objectStore('objects')\n    return new Promise((resolve, reject) => {\n      const req = store.getAllKeys()\n      req.onsuccess = () => {\n        resolve(req.result)\n      }\n      req.onerror = () => reject(req.error)\n    })\n  }\n\n  async delete(id: string): Promise<void> {\n    const db = await this.dbPromise\n    const tx = db.transaction('objects', 'readwrite')\n    const store = tx.objectStore('objects')\n    return new Promise((resolve, reject) => {\n      const req = store.delete(id)\n      req.onsuccess = resolve\n      req.onerror = () => reject(req.error)\n    })\n  }\n\n  async clear(): Promise<void> {\n    const db = await this.dbPromise\n    const tx = db.transaction('objects', 'readwrite')\n    const store = tx.objectStore('objects')\n    return new Promise((resolve, reject) => {\n      const req = store.clear()\n      req.onsuccess = resolve\n      req.onerror = () => reject(req.error)\n    })\n  }\n}\n\nexport const indexedStorage = new IndexedStorage('default-local-db')\n"],"names":["$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","$f534e8972a5b1be2$exports","$f534e8972a5b1be2$export$41a78aa1acdd6131","$f534e8972a5b1be2$export$5281f72867bab9d2","indexedDB","$f534e8972a5b1be2$var$indexedDB","window","VERSION","request","promiseFulfilled","dbPromise","success","result","update","db","createObjectStore","keyPath","name","open","onsuccess","onupgradeneeded","Promise","resolve","setItem","id","value","store","tx","transaction","objectStore","reject","req","put","onerror","error","getItem","undefined","count","allKeys","getAllKeys","delete","clear","IndexedStorage","indexedStorage"],"version":3,"file":"index.js.map"}